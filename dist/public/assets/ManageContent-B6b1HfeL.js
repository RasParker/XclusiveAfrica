import{i as G,r as m,j as e,C as I,g as D,l as R,B as c,a as O,b as Q,u as Y,L as C,D as J,p as X,q as $,s as q,E as K}from"./index-DnjzDop3.js";import{T as ee,a as se,b as V,c as W}from"./tabs-Tn3DyEKi.js";import{E as z}from"./eye-DwXGc38I.js";import{H as te}from"./heart-BIzJO6uv.js";import{S as ae}from"./square-pen-CNc_pLH1.js";import{C as re}from"./circle-check-big-CTWGQ5qD.js";import{T as le}from"./trash-2-DTtK-_sv.js";import{F as f}from"./file-text-CmNfjj7m.js";import{V as ne}from"./video-DbSLhckN.js";import{I as ie}from"./image-DUscFDhE.js";import{P as ce}from"./plus-9blh9VHl.js";import{A as oe}from"./arrow-left-DJTbtmZM.js";/**
 * @license lucide-react v0.453.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const de=G("MessageCircle",[["path",{d:"M7.9 20A9 9 0 1 0 4 16.1L2 22Z",key:"vv11sd"}]]),Z=({id:l,caption:u,type:o,tier:n,status:d,date:b,views:g,likes:a,comments:p,mediaPreview:N,category:P,scheduledFor:x,onEdit:S,onDelete:w,onPublish:v,onViewContent:y})=>{m.useState(!1);const M=()=>{switch(o){case"Image":return e.jsx(ie,{className:"w-4 h-4"});case"Video":return e.jsx(ne,{className:"w-4 h-4"});case"Text":return e.jsx(f,{className:"w-4 h-4"});default:return e.jsx(f,{className:"w-4 h-4"})}},E=r=>{switch(r){case"Free":return"outline";case"Basic":return"secondary";case"Premium":return"default";default:return"outline"}};return e.jsx(I,{className:"bg-gradient-card border-border/50 hover:border-primary/20 transition-all duration-200",children:e.jsx(D,{className:"p-3",children:e.jsxs("div",{className:"flex items-center gap-3 p-3 bg-background/50 rounded-lg",children:[e.jsx("div",{className:"flex-shrink-0",children:N?o==="Video"?e.jsx("video",{src:N,className:"w-16 h-16 object-cover rounded-lg",muted:!0,preload:"metadata"}):e.jsx("img",{src:N,alt:u,className:"w-16 h-16 object-cover rounded-lg",onError:r=>{const h=r.target;h.src="data:image/svg+xml;base64,PHN2ZyB3aWR0aD0iMjAwIiBoZWlnaHQ9IjIwMCIgdmlld0JveD0iMCAwIDIwMCAyMDAiIGZpbGw9Im5vbmUiIHhtbG5zPSJodHRwOi8vd3d3LnczLm9yZy8yMDAwL3N2ZyI+CjxyZWN0IHdpZHRoPSIyMDAiIGhlaWdodD0iMjAwIiBmaWxsPSIjZjNmNGY2Ii8+CjxwYXRoIGQ9Ik0xMDAgNzVMMTI1IDEwMEgxMTJWMTI1SDg4VjEwMEg3NUwxMDAgNzVaIiBmaWxsPSIjOWNhM2FmIi8+Cjx0ZXh0IHg9IjEwMCIgeT0iMTUwIiB0ZXh0LWFuY2hvcj0ibWlkZGxlIiBmaWxsPSIjOWNhM2FmIiBmb250LXNpemU9IjEyIj5JbWFnZSBub3QgZm91bmQ8L3RleHQ+Cjwvc3ZnPg==",h.className="w-full h-full object-cover opacity-50"}}):e.jsx("div",{className:"w-16 h-16 bg-gradient-to-br from-accent/20 to-accent/10 rounded-lg flex items-center justify-center",children:M()})}),e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsx("h4",{className:"font-medium text-sm mb-0.5 overflow-hidden",style:{display:"-webkit-box",WebkitLineClamp:1,WebkitBoxOrient:"vertical",textOverflow:"ellipsis"},title:u,children:u}),e.jsxs("div",{className:"flex items-center gap-2 mb-1",children:[e.jsx(R,{variant:E(n),className:"text-xs",children:n}),d==="Scheduled"&&x?e.jsxs(e.Fragment,{children:[e.jsx("span",{className:"text-xs text-muted-foreground",children:new Date(x).toLocaleDateString("en-US",{month:"short",day:"numeric",year:"numeric"})}),e.jsx("span",{className:"text-xs text-accent",children:new Date(x).toLocaleTimeString("en-US",{hour:"numeric",minute:"2-digit",hour12:!0})})]}):e.jsx("span",{className:"text-xs text-muted-foreground",children:b})]}),e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsxs("div",{className:"flex items-center gap-1 text-xs text-muted-foreground",children:[e.jsx(z,{className:"w-3 h-3"}),e.jsx("span",{children:g})]}),e.jsxs("div",{className:"flex items-center gap-1 text-xs text-muted-foreground",children:[e.jsx(te,{className:"w-3 h-3"}),e.jsx("span",{children:a})]}),e.jsxs("div",{className:"flex items-center gap-1 text-xs text-muted-foreground",children:[e.jsx(de,{className:"w-3 h-3"}),e.jsx("span",{children:p})]})]}),e.jsxs("div",{className:"flex items-center gap-1",children:[e.jsx(c,{variant:"ghost",size:"sm",onClick:r=>{r.preventDefault(),y({id:l,caption:u,type:o,tier:n,status:d,date:b,views:g,likes:a,comments:p,mediaPreview:N,category:P,scheduledFor:x})},className:"h-8 w-8 p-0",children:e.jsx(z,{className:"w-4 h-4"})}),e.jsx(c,{variant:"ghost",size:"sm",onClick:r=>{r.preventDefault(),S(l)},className:"h-8 w-8 p-0",children:e.jsx(ae,{className:"w-4 h-4"})}),d==="Draft"&&e.jsx(c,{variant:"ghost",size:"sm",onClick:r=>{r.preventDefault(),v(l)},className:"h-8 w-8 p-0 text-success",children:e.jsx(re,{className:"w-4 h-4"})}),e.jsx(c,{variant:"ghost",size:"sm",onClick:r=>{r.preventDefault(),w(l)},className:"h-8 w-8 p-0 text-destructive hover:text-destructive/80",children:e.jsx(le,{className:"w-4 h-4"})})]})]})]})]})})})},ye=()=>{const{toast:l}=O(),u=Q(),{user:o}=Y(),[n,d]=m.useState([]),[b,g]=m.useState(!0),[a,p]=m.useState(null),[N,P]=m.useState(!1),[x,S]=m.useState("published");m.useEffect(()=>{const s=async()=>{if(o)try{g(!0);const i=await fetch(`/api/posts?creatorId=${o.id}&includeAll=true`);if(i.ok){const H=(await i.json()).map(t=>{let U=null;if(t.media_urls){const A=Array.isArray(t.media_urls)?t.media_urls:[t.media_urls];if(A.length>0&&A[0]){const B=A[0];U=B.startsWith("/uploads/")?B:`/uploads/${B}`}}return{id:t.id.toString(),caption:t.content||t.title,type:t.media_type==="image"?"Image":t.media_type==="video"?"Video":"Text",tier:t.tier==="public"?"Free":t.tier.toLowerCase()==="starter pump"?"Starter Pump":t.tier.toLowerCase()==="power gains"?"Power Gains":t.tier.toLowerCase()==="elite beast mode"?"Elite Beast Mode":t.tier.toLowerCase().includes("starter")?"Starter Pump":t.tier.toLowerCase().includes("power")?"Power Gains":t.tier.toLowerCase().includes("elite")||t.tier.toLowerCase().includes("beast")?"Elite Beast Mode":t.tier,status:t.status==="draft"?"Draft":t.status==="scheduled"?"Scheduled":"Published",date:t.created_at==="CURRENT_TIMESTAMP"?new Date().toLocaleDateString("en-US",{month:"short",day:"numeric",year:"numeric"}):new Date(t.created_at).toLocaleDateString("en-US",{month:"short",day:"numeric",year:"numeric"}),views:0,likes:t.likes_count||0,comments:t.comments_count||0,mediaPreview:U,category:"General",scheduledFor:t.scheduled_for||null}});d(H),console.log("Fetched user content:",H)}}catch(i){console.error("Error fetching content:",i),l({title:"Error",description:"Failed to load your content. Please try again.",variant:"destructive"})}finally{g(!1)}};s();const j=()=>{s()};return window.addEventListener("localStorageChange",j),()=>window.removeEventListener("localStorageChange",j)},[o,l]);const w=n.filter(s=>s.status==="Published"),v=n.filter(s=>s.status==="Scheduled"),y=n.filter(s=>s.status==="Draft"),M=n.filter(s=>s.status==="Published"),E=n.filter(s=>s.status==="Scheduled"),r=n.filter(s=>s.status==="Draft"),h=s=>{u(`/creator/edit-post/${s}`)},L=async s=>{try{if((await fetch(`/api/posts/${s}`,{method:"DELETE"})).ok)d(i=>i.filter(_=>_.id!==s)),l({title:"Content deleted",description:"Your content has been deleted successfully."});else throw new Error("Failed to delete post")}catch{l({title:"Error",description:"Failed to delete content. Please try again.",variant:"destructive"})}},T=s=>{d(j=>j.map(i=>i.id===s?{...i,status:"Published"}:i)),l({title:"Content published",description:"Your content has been published successfully."})},k=s=>{p(s)},F=()=>{p(null),P(!1)};return e.jsxs("div",{className:"min-h-screen bg-background",children:[e.jsxs("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-8",children:[e.jsxs("div",{className:"mb-8 text-center sm:text-left",children:[e.jsx("h1",{className:"text-2xl sm:text-3xl font-bold text-foreground mb-2 flex items-center gap-2 justify-center sm:justify-start",children:"Manage Content"}),e.jsx("p",{className:"text-sm sm:text-base text-muted-foreground",children:"View and edit all your published posts"})]}),e.jsx("div",{className:"flex flex-col sm:flex-row sm:items-center sm:justify-between gap-4",children:e.jsx(c,{asChild:!0,className:"w-full sm:w-auto",children:e.jsxs(C,{to:"/creator/upload",children:[e.jsx(ce,{className:"w-4 h-4 mr-2"}),"Create Content"]})})}),b?e.jsx("div",{className:"flex items-center justify-center py-12",children:e.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-primary"})}):e.jsxs(ee,{value:x,onValueChange:S,className:"space-y-6",children:[e.jsxs(se,{className:"mb-6",children:[e.jsxs(V,{value:"published",children:["Published",e.jsx("span",{className:"ml-2 text-xs opacity-70",children:M.length})]}),e.jsxs(V,{value:"scheduled",children:["Scheduled",e.jsx("span",{className:"ml-2 text-xs opacity-70",children:E.length})]}),e.jsxs(V,{value:"drafts",children:["Drafts",e.jsx("span",{className:"ml-2 text-xs opacity-70",children:r.length})]})]}),e.jsx(W,{value:"published",className:"space-y-4",children:w.length>0?e.jsx("div",{className:"space-y-3",children:w.map(s=>e.jsx(Z,{...s,onEdit:h,onDelete:L,onPublish:T,onViewContent:k},s.id))}):e.jsx(I,{className:"bg-gradient-card border-border/50",children:e.jsxs(D,{className:"flex flex-col items-center justify-center py-12",children:[e.jsx(f,{className:"w-12 h-12 text-muted-foreground mb-4"}),e.jsx("h3",{className:"text-lg font-medium text-foreground mb-2",children:"No published content"}),e.jsx("p",{className:"text-muted-foreground text-center mb-4",children:"Publish your first post to get started"}),e.jsx(c,{asChild:!0,children:e.jsx(C,{to:"/creator/upload",children:"Create Content"})})]})})}),e.jsx(W,{value:"scheduled",className:"space-y-4",children:v.length>0?e.jsx("div",{className:"space-y-3",children:v.map(s=>e.jsx(Z,{...s,onEdit:h,onDelete:L,onPublish:T,onViewContent:k},s.id))}):e.jsx(I,{className:"bg-gradient-card border-border/50",children:e.jsxs(D,{className:"flex flex-col items-center justify-center py-12",children:[e.jsx(f,{className:"w-12 h-12 text-muted-foreground mb-4"}),e.jsx("h3",{className:"text-lg font-medium text-foreground mb-2",children:"No scheduled content"}),e.jsx("p",{className:"text-muted-foreground text-center mb-4",children:"Schedule posts to publish them automatically"}),e.jsx(c,{asChild:!0,children:e.jsx(C,{to:"/creator/upload",children:"Create Content"})})]})})}),e.jsx(W,{value:"drafts",className:"space-y-4",children:y.length>0?e.jsx("div",{className:"space-y-3",children:y.map(s=>e.jsx(Z,{...s,onEdit:h,onDelete:L,onPublish:T,onViewContent:k},s.id))}):e.jsx(I,{className:"bg-gradient-card border-border/50",children:e.jsxs(D,{className:"flex flex-col items-center justify-center py-12",children:[e.jsx(f,{className:"w-12 h-12 text-muted-foreground mb-4"}),e.jsx("h3",{className:"text-lg font-medium text-foreground mb-2",children:"No draft content"}),e.jsx("p",{className:"text-muted-foreground text-center mb-4",children:"Save drafts to work on them later"}),e.jsx(c,{asChild:!0,children:e.jsx(C,{to:"/creator/upload",children:"Create Content"})})]})})})]})]}),e.jsx(J,{open:!!a,onOpenChange:s=>!s&&F(),children:e.jsxs(X,{className:"max-w-full max-h-full w-screen h-screen p-0 m-0 overflow-hidden border-0 [&>button]:hidden",children:[e.jsxs($,{className:"sr-only",children:[e.jsxs(q,{children:[a==null?void 0:a.type," Content"]}),e.jsx(K,{children:"View content"})]}),a&&e.jsxs("div",{className:"relative w-screen h-screen bg-black",children:[e.jsx(c,{variant:"ghost",size:"sm",className:"absolute top-4 left-4 z-50 w-10 h-10 rounded-full text-white hover:bg-white/10",onClick:F,children:e.jsx(oe,{className:"w-7 h-7"})}),a.mediaPreview?a.type==="Video"?e.jsx("video",{src:a.mediaPreview,className:"w-full h-full",controls:!0,autoPlay:!0,muted:!0,style:{objectFit:"contain"}}):e.jsx("img",{src:a.mediaPreview,alt:a.caption,className:"w-full h-full",style:{objectFit:"contain"}}):e.jsx("div",{className:"w-full h-full flex items-center justify-center",children:e.jsxs("div",{className:"text-center px-6 text-white",children:[e.jsx("div",{className:"w-16 h-16 mx-auto mb-4 rounded-full bg-white/20 flex items-center justify-center",children:e.jsx(f,{className:"w-8 h-8"})}),e.jsx("h3",{className:"font-semibold text-xl mb-4",children:a.caption}),e.jsx("p",{className:"text-sm text-white/70",children:"Text post"})]})})]})]})})]})};export{ye as ManageContent};
