import{a as V,r,aw as y,j as e,ab as A,C as N,g as w,B as l,d as D,e as z,f as L,l as m}from"./index-DnjzDop3.js";import{S as x,a as u,b as h,c as p,d as t}from"./select-BgAE-lOE.js";import{E as U}from"./EdgeToEdgeContainer-kS07pzFb.js";import{F as B}from"./file-text-CmNfjj7m.js";import{F as I}from"./flag-D_PcH8BI.js";import{C as $}from"./circle-check-big-CTWGQ5qD.js";import{T as H}from"./triangle-alert-Dv17xG_Y.js";import{C as M}from"./clock-DLXk1hVQ.js";import"./chevron-up-CD9nw7va.js";const Z=()=>{const{toast:n}=V(),[j,g]=r.useState([]),[b,C]=r.useState(!0),[d,S]=r.useState("all"),[c,R]=r.useState("all"),[o,F]=r.useState("all");r.useEffect(()=>{T()},[]);const T=async()=>{try{const s=await y("/api/admin/reports");g(s)}catch(s){console.error("Error fetching reports:",s)}finally{C(!1)}},f=j.filter(s=>{const i=d==="all"||s.status===d,a=c==="all"||s.type===c,E=o==="all"||s.priority===o;return i&&a&&E}),v=async(s,i)=>{try{await y(`/api/admin/reports/${s}/status`,{method:"PUT",body:JSON.stringify({status:i})}),g(j.map(a=>a.id===parseInt(s)?{...a,status:i,updated_at:new Date().toISOString()}:a)),n({title:"Report status updated",description:`Report has been marked as ${i}.`})}catch{n({title:"Error",description:"Failed to update report status.",variant:"destructive"})}},k=s=>{n({title:"Report Details",description:`Viewing details for report ${s}`})},P=s=>{switch(s){case"pending":return e.jsx(M,{className:"w-4 h-4"});case"under_review":return e.jsx(H,{className:"w-4 h-4"});case"resolved":return e.jsx($,{className:"w-4 h-4"});default:return e.jsx(I,{className:"w-4 h-4"})}},_=s=>{switch(s){case"high":return"destructive";case"medium":return"secondary";case"low":return"outline";default:return"outline"}};return e.jsx(A,{children:e.jsxs(U,{maxWidth:"7xl",enablePadding:!0,enableTopPadding:!0,children:[e.jsxs("div",{className:"mb-8 text-center sm:text-left",children:[e.jsxs("h1",{className:"text-2xl sm:text-3xl font-bold text-foreground mb-2 flex items-center gap-2 justify-center sm:justify-start",children:[e.jsx(B,{className:"w-6 h-6 sm:w-8 sm:h-8 text-primary"}),"Reports & Analytics"]}),e.jsx("p",{className:"text-sm sm:text-base text-muted-foreground",children:"View platform reports and user activity"})]}),e.jsx(N,{className:"bg-gradient-card border-border/50 mb-6",children:e.jsx(w,{className:"p-6",children:e.jsxs("div",{className:"grid md:grid-cols-4 gap-4",children:[e.jsxs(x,{value:d,onValueChange:S,children:[e.jsx(u,{children:e.jsx(h,{placeholder:"Filter by status"})}),e.jsxs(p,{children:[e.jsx(t,{value:"all",children:"All Status"}),e.jsx(t,{value:"pending",children:"Pending"}),e.jsx(t,{value:"under_review",children:"Under Review"}),e.jsx(t,{value:"resolved",children:"Resolved"})]})]}),e.jsxs(x,{value:c,onValueChange:R,children:[e.jsx(u,{children:e.jsx(h,{placeholder:"Filter by type"})}),e.jsxs(p,{children:[e.jsx(t,{value:"all",children:"All Types"}),e.jsx(t,{value:"content",children:"Content"}),e.jsx(t,{value:"user",children:"User"}),e.jsx(t,{value:"payment",children:"Payment"})]})]}),e.jsxs(x,{value:o,onValueChange:F,children:[e.jsx(u,{children:e.jsx(h,{placeholder:"Filter by priority"})}),e.jsxs(p,{children:[e.jsx(t,{value:"all",children:"All Priorities"}),e.jsx(t,{value:"high",children:"High"}),e.jsx(t,{value:"medium",children:"Medium"}),e.jsx(t,{value:"low",children:"Low"})]})]}),e.jsx(l,{variant:"outline",children:"Export Reports"})]})})}),e.jsxs(N,{className:"bg-gradient-card border-border/50",children:[e.jsxs(D,{children:[e.jsxs(z,{children:["Platform Reports (",f.length,")"]}),e.jsx(L,{children:"Manage reports and violations"})]}),e.jsx(w,{children:b?e.jsx("div",{className:"flex justify-center py-8",children:e.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-primary"})}):e.jsx("div",{className:"space-y-4",children:f.map(s=>e.jsxs("div",{className:"p-6 rounded-lg border border-border/50 bg-muted/10",children:[e.jsxs("div",{className:"flex flex-col lg:flex-row lg:items-start lg:justify-between mb-4 gap-4",children:[e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsxs("div",{className:"flex flex-wrap items-center gap-2 mb-2",children:[e.jsx("h3",{className:"text-lg font-semibold text-foreground truncate",children:s.reason}),e.jsx(m,{variant:"outline",className:"capitalize shrink-0",children:s.type}),e.jsx(m,{variant:_(s.priority),className:"capitalize shrink-0",children:s.priority})]}),e.jsx("p",{className:"text-sm text-muted-foreground mb-3 break-words",children:s.description}),e.jsxs("div",{className:"grid md:grid-cols-2 gap-4 text-sm",children:[e.jsxs("div",{className:"min-w-0",children:[e.jsx("span",{className:"text-muted-foreground",children:"Reported by:"}),e.jsx("span",{className:"ml-2 font-medium truncate",children:s.reported_by})]}),e.jsxs("div",{className:"min-w-0",children:[e.jsx("span",{className:"text-muted-foreground",children:"Target:"}),e.jsx("span",{className:"ml-2 font-medium truncate",children:s.target})]}),e.jsxs("div",{children:[e.jsx("span",{className:"text-muted-foreground",children:"Created:"}),e.jsx("span",{className:"ml-2 text-xs",children:new Date(s.created_at).toLocaleString()})]}),e.jsxs("div",{children:[e.jsx("span",{className:"text-muted-foreground",children:"Updated:"}),e.jsx("span",{className:"ml-2 text-xs",children:new Date(s.updated_at).toLocaleString()})]})]})]}),e.jsx("div",{className:"flex items-center justify-end lg:justify-start shrink-0",children:e.jsxs(m,{variant:s.status==="pending"?"destructive":s.status==="under_review"?"secondary":"default",className:"flex items-center gap-1 whitespace-nowrap",children:[P(s.status),s.status.replace("_"," ")]})})]}),e.jsxs("div",{className:"flex flex-wrap gap-2",children:[s.status==="pending"&&e.jsx(l,{variant:"outline",size:"sm",onClick:()=>v(s.id,"under_review"),children:"Start Review"}),s.status==="under_review"&&e.jsx(l,{size:"sm",onClick:()=>v(s.id,"resolved"),children:"Resolve"}),e.jsx(l,{variant:"outline",size:"sm",onClick:()=>k(s.id),children:"View Details"})]})]},s.id))})})]})]})})};export{Z as Reports};
