import{r as o,a as M,aw as u,j as e,C as g,g as h,B as l,d as A,e as L,I as f,l as T,o as B}from"./index-DnjzDop3.js";import{P as D}from"./plus-9blh9VHl.js";import{S as F}from"./square-pen-CNc_pLH1.js";import{T as q}from"./trash-2-DTtK-_sv.js";const O=()=>{const[p,d]=o.useState([]),[w,v]=o.useState(!0),[N,y]=o.useState(null),[m,j]=o.useState({name:"",description:""}),[r,c]=o.useState(null),[i,x]=o.useState(!1),{toast:n}=M();o.useEffect(()=>{b()},[]);const b=async()=>{try{v(!0),y(null);const s=await u("/api/admin/categories");d(Array.isArray(s)?s:[])}catch(s){console.error("Error fetching categories:",s),y(s instanceof Error?s.message:"Failed to load categories"),d([])}finally{v(!1)}},E=async s=>{if(s.preventDefault(),!m.name.trim()){n({title:"Error",description:"Category name is required",variant:"destructive"});return}try{x(!0);const t=await u("/api/admin/categories",{method:"POST",body:JSON.stringify(m)});d(a=>[...a,t]),j({name:"",description:""}),n({title:"Success",description:"Category created successfully"})}catch(t){console.error("Error creating category:",t),n({title:"Error",description:t instanceof Error?t.message:"Failed to create category",variant:"destructive"})}finally{x(!1)}},S=async s=>{if(s.preventDefault(),!!r)try{x(!0);const t=await u(`/api/admin/categories/${r.id}`,{method:"PUT",body:JSON.stringify({name:r.name,description:r.description})});d(a=>a.map(C=>C.id===t.id?t:C)),c(null),n({title:"Success",description:"Category updated successfully"})}catch(t){console.error("Error updating category:",t),n({title:"Error",description:t instanceof Error?t.message:"Failed to update category",variant:"destructive"})}finally{x(!1)}},k=async s=>{if(confirm("Are you sure you want to delete this category?"))try{await u(`/api/admin/categories/${s}`,{method:"DELETE"}),d(t=>t.filter(a=>a.id!==s)),n({title:"Success",description:"Category deleted successfully"})}catch(t){console.error("Error deleting category:",t),n({title:"Error",description:t instanceof Error?t.message:"Failed to delete category",variant:"destructive"})}};return w?e.jsxs("div",{className:"container mx-auto p-6 max-w-6xl",children:[e.jsxs("div",{className:"mb-6",children:[e.jsx("h1",{className:"text-2xl font-bold text-foreground",children:"Manage Categories"}),e.jsx("p",{className:"text-muted-foreground mt-2",children:"Loading categories..."})]}),e.jsx("div",{className:"flex items-center justify-center min-h-[200px]",children:e.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-primary"})})]}):N?e.jsxs("div",{className:"container mx-auto p-6 max-w-6xl",children:[e.jsx("div",{className:"mb-6",children:e.jsx("h1",{className:"text-2xl font-bold text-foreground",children:"Manage Categories"})}),e.jsx(g,{children:e.jsx(h,{className:"p-6",children:e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:"text-red-500 mb-4",children:e.jsx("svg",{className:"w-12 h-12 mx-auto",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 8v4m0 4h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z"})})}),e.jsx("h3",{className:"text-lg font-medium text-foreground mb-2",children:"Error Loading Categories"}),e.jsx("p",{className:"text-muted-foreground mb-4",children:N}),e.jsx(l,{onClick:b,variant:"outline",children:"Try Again"})]})})})]}):e.jsxs("div",{className:"container mx-auto p-6 max-w-6xl",children:[e.jsxs("div",{className:"mb-6",children:[e.jsx("h1",{className:"text-2xl font-bold text-foreground",children:"Manage Categories"}),e.jsx("p",{className:"text-muted-foreground mt-2",children:"Create and manage content categories for creators"})]}),e.jsxs(g,{className:"mb-6",children:[e.jsx(A,{children:e.jsxs(L,{className:"flex items-center gap-2",children:[e.jsx(D,{className:"w-5 h-5"}),"Add New Category"]})}),e.jsx(h,{children:e.jsxs("form",{onSubmit:E,className:"space-y-4",children:[e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-foreground mb-2",children:"Category Name *"}),e.jsx(f,{type:"text",value:m.name,onChange:s=>j(t=>({...t,name:s.target.value})),placeholder:"e.g., Fitness, Gaming, Art",required:!0,disabled:i})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-foreground mb-2",children:"Description"}),e.jsx(f,{type:"text",value:m.description,onChange:s=>j(t=>({...t,description:s.target.value})),placeholder:"Brief description of the category",disabled:i})]})]}),e.jsx(l,{type:"submit",disabled:i,children:i?"Creating...":"Create Category"})]})})]}),e.jsx("div",{className:"grid gap-4",children:p.length===0?e.jsx(g,{children:e.jsx(h,{className:"p-6",children:e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:"text-muted-foreground mb-4",children:e.jsx("svg",{className:"w-12 h-12 mx-auto",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M19 11H5m14 0a2 2 0 012 2v6a2 2 0 01-2 2H5a2 2 0 01-2-2v-6a2 2 0 012-2m14 0V9a2 2 0 00-2-2M5 11V9a2 2 0 012-2m0 0V5a2 2 0 012-2h6a2 2 0 012 2v2M7 7h10"})})}),e.jsx("h3",{className:"text-lg font-medium text-foreground mb-2",children:"No Categories Found"}),e.jsx("p",{className:"text-muted-foreground",children:"Create your first category to get started"})]})})}):p.map(s=>e.jsx(g,{children:e.jsx(h,{className:"p-6",children:(r==null?void 0:r.id)===s.id?e.jsxs("form",{onSubmit:S,className:"space-y-4",children:[e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-foreground mb-2",children:"Category Name *"}),e.jsx(f,{type:"text",value:r.name,onChange:t=>c(a=>a?{...a,name:t.target.value}:null),required:!0,disabled:i})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-foreground mb-2",children:"Description"}),e.jsx(f,{type:"text",value:r.description,onChange:t=>c(a=>a?{...a,description:t.target.value}:null),disabled:i})]})]}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx(l,{type:"submit",disabled:i,children:i?"Saving...":"Save Changes"}),e.jsx(l,{type:"button",variant:"outline",onClick:()=>c(null),disabled:i,children:"Cancel"})]})]}):e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex-1",children:[e.jsxs("div",{className:"flex items-center gap-3 mb-2",children:[e.jsx("h3",{className:"text-lg font-semibold text-foreground",children:s.name}),e.jsx(T,{variant:s.is_active?"default":"secondary",children:s.is_active?"Active":"Inactive"}),e.jsxs("div",{className:"flex items-center gap-1 text-muted-foreground",children:[e.jsx(B,{className:"w-4 h-4"}),e.jsxs("span",{className:"text-sm",children:[s.creator_count," creators"]})]})]}),s.description&&e.jsx("p",{className:"text-muted-foreground text-sm",children:s.description})]}),e.jsxs("div",{className:"flex gap-2 ml-4",children:[e.jsx(l,{variant:"outline",size:"sm",onClick:()=>c(s),children:e.jsx(F,{className:"w-4 h-4"})}),e.jsx(l,{variant:"destructive",size:"sm",onClick:()=>k(s.id),children:e.jsx(q,{className:"w-4 h-4"})})]})]})})},s.id))})]})};export{O as default};
