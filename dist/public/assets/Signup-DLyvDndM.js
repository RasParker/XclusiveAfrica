import{i as me,r as a,u as ue,a as xe,b as he,j as e,C as ge,d as pe,f as fe,g as ye,B as f,L as Y,h as u,U as w,k as q,I as y,l as I,H as je}from"./index-DnjzDop3.js";import{S as be,a as ve,b as Ne,c as we,d as z}from"./select-BgAE-lOE.js";import{T as Ce}from"./textarea-ChWCN1Go.js";import{A as Se}from"./arrow-left-DJTbtmZM.js";import{E as G}from"./eye-off-Bcppvf7W.js";import{E as H}from"./eye-DwXGc38I.js";import{P as Pe}from"./plus-9blh9VHl.js";import{P as ke}from"./palette-DQH6SLVE.js";import{D as Ee,M as Fe,L as Re,C as Le,S as Ae,G as $e,B as Te,a as De}from"./shirt-HfxHFPZG.js";import"./chevron-up-CD9nw7va.js";/**
 * @license lucide-react v0.453.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Me=me("ArrowRight",[["path",{d:"M5 12h14",key:"1ays0h"}],["path",{d:"m12 5 7 7-7 7",key:"xquz4c"}]]),O={Palette:ke,Dumbbell:Ee,Music:Fe,Laptop:Re,ChefHat:Le,Shirt:Ae,Gamepad2:$e,Briefcase:Te,Home:je,GraduationCap:De},Ve=()=>{const[l,F]=a.useState(1),[j,X]=a.useState(""),[g,V]=a.useState(""),[p,W]=a.useState(""),[C,_]=a.useState(""),[n,J]=a.useState("fan"),[o,R]=a.useState([]),[x,b]=a.useState(null),[c,L]=a.useState(""),[A,$]=a.useState(""),[v,T]=a.useState([]),[K,D]=a.useState(!1),[S,Q]=a.useState(!1),[P,Z]=a.useState(!1),[M,k]=a.useState(!1),[h,B]=a.useState(!1),{signup:ee}=ue(),{toast:d}=xe(),se=he(),E=n==="creator"?3:2;a.useEffect(()=>{(async()=>{if(n==="creator"){D(!0);try{const t=await fetch("/api/categories");if(t.ok){const r=await t.json();T(r)}else console.error("Failed to fetch categories")}catch(t){console.error("Error fetching categories:",t)}finally{D(!1)}}else R([]),b(null),T([]),L(""),$("")})()},[n]);const m=4,te=s=>{R(t=>{const r=t.includes(s);if(!r&&t.length>=m)return d({title:"Category limit reached",description:`You can select a maximum of ${m} categories (1 primary + ${m-1} secondary).`,variant:"destructive"}),t;const i=r?t.filter(N=>N!==s):[...t,s];return r&&x===s&&b(null),!r&&i.length===1&&b(s),i})},re=()=>{if(l===1){if(!j||!g||!p||!C){d({title:"Missing information",description:"Please fill in all required fields.",variant:"destructive"});return}if(p!==C){d({title:"Password mismatch",description:"Passwords do not match. Please try again.",variant:"destructive"});return}if(p.length<6){d({title:"Password too short",description:"Password must be at least 6 characters long.",variant:"destructive"});return}}if(l===2&&n==="creator"){if(o.length===0&&!c.trim()){d({title:"Category required",description:"Please select at least one category or create a custom category.",variant:"destructive"});return}if(!x&&!c.trim()){d({title:"Primary category required",description:"Please select a primary category or create a custom category.",variant:"destructive"});return}}F(s=>Math.min(s+1,E))},ae=()=>{F(s=>Math.max(s-1,1)),B(!1)},ie=async s=>{if(s.preventDefault(),l===E&&!h){B(!0);return}k(!0);try{let t=x;if(c.trim())try{const i=await fetch("/api/categories",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({name:c.trim(),slug:c.toLowerCase().replace(/\s+/g,"-").replace(/[^a-z0-9-]/g,""),description:A.trim()||`${c} category`,icon:"User",color:"#6366f1"})});if(i.ok)t=(await i.json()).id;else throw new Error("Failed to create custom category")}catch(i){console.error("Error creating custom category:",i),d({title:"Category creation failed",description:"Failed to create custom category. Please try again.",variant:"destructive"}),k(!1);return}await ee(j,p,g,n,t||void 0),d({title:"Welcome to Xclusive!",description:`Your ${n} account has been created successfully.`}),se(n==="creator"?"/creator/dashboard":"/fan/dashboard")}catch(t){console.error("Signup error:",t);let r="Something went wrong";t instanceof Error&&(r=t.message),r.includes("Email already exists")?r="An account with this email already exists. Please use a different email or try logging in.":r.includes("Username already exists")?r="This username is already taken. Please choose a different username.":r.includes("Failed to create user account")&&(r="Unable to create your account. Please try again or contact support."),d({title:"Signup failed",description:r,variant:"destructive"})}finally{k(!1)}},oe=()=>e.jsx("div",{className:"flex justify-center mb-6",children:e.jsxs(Y,{to:"/",className:"inline-flex items-center space-x-2",children:[e.jsx("div",{className:"w-10 h-10 bg-gradient-primary rounded-xl flex items-center justify-center",children:e.jsx("span",{className:"text-primary-foreground font-bold text-xl",children:"X"})}),e.jsx("span",{className:"text-2xl font-bold text-gradient-primary",children:"Xclusive"})]})}),le=()=>e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(u,{children:"I want to join as:"}),e.jsxs(be,{value:n,onValueChange:s=>J(s),children:[e.jsx(ve,{children:e.jsx(Ne,{placeholder:"Choose your account type"})}),e.jsxs(we,{children:[e.jsx(z,{value:"fan",children:e.jsxs("div",{className:"flex items-start space-x-2",children:[e.jsx(w,{className:"w-4 h-4 text-blue-500 mt-0.5"}),e.jsxs("div",{className:"text-left",children:[e.jsx("div",{className:"font-medium",children:"Fan"}),e.jsx("div",{className:"text-xs text-muted-foreground",children:"Support and follow creators"})]})]})}),e.jsx(z,{value:"creator",children:e.jsxs("div",{className:"flex items-start space-x-2",children:[e.jsx(q,{className:"w-4 h-4 text-blue-500 mt-0.5"}),e.jsxs("div",{className:"text-left",children:[e.jsx("div",{className:"font-medium",children:"Creator"}),e.jsx("div",{className:"text-xs text-muted-foreground",children:"Monetize your content"})]})]})})]})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(u,{htmlFor:"email",children:"Email"}),e.jsx(y,{id:"email",type:"email",placeholder:"Enter your email",value:j,onChange:s=>X(s.target.value),required:!0})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(u,{htmlFor:"username",children:"Username"}),e.jsx(y,{id:"username",type:"text",placeholder:"Choose a username",value:g,onChange:s=>V(s.target.value),required:!0})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(u,{htmlFor:"password",children:"Password"}),e.jsxs("div",{className:"relative",children:[e.jsx(y,{id:"password",type:S?"text":"password",placeholder:"Create a password",value:p,onChange:s=>W(s.target.value),required:!0}),e.jsx(f,{type:"button",variant:"ghost",size:"icon",className:"absolute right-0 top-0 h-full px-3 py-2 hover:bg-transparent",onClick:()=>Q(!S),children:S?e.jsx(G,{className:"h-4 w-4"}):e.jsx(H,{className:"h-4 w-4"})})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(u,{htmlFor:"confirmPassword",children:"Confirm Password"}),e.jsxs("div",{className:"relative",children:[e.jsx(y,{id:"confirmPassword",type:P?"text":"password",placeholder:"Confirm your password",value:C,onChange:s=>_(s.target.value),required:!0}),e.jsx(f,{type:"button",variant:"ghost",size:"icon",className:"absolute right-0 top-0 h-full px-3 py-2 hover:bg-transparent",onClick:()=>Z(!P),children:P?e.jsx(G,{className:"h-4 w-4"}):e.jsx(H,{className:"h-4 w-4"})})]})]})]}),ne=()=>n==="fan"?e.jsxs("div",{className:"space-y-6",children:[e.jsx("div",{className:"text-center space-y-2",children:h?e.jsx(e.Fragment,{children:e.jsx("h3",{className:"text-xl font-semibold",children:"Complete your fan profile"})}):e.jsxs(e.Fragment,{children:[e.jsx("h3",{className:"text-xl font-semibold",children:"Ready to Explore!"}),e.jsx("p",{className:"text-sm text-muted-foreground",children:"Review your profile details below and complete your registration when ready."})]})}),e.jsxs("div",{className:"text-center space-y-4",children:[e.jsx("div",{className:"w-12 h-12 bg-blue-100 dark:bg-blue-900/30 rounded-full flex items-center justify-center mx-auto",children:e.jsx(w,{className:"w-6 h-6 text-blue-600 dark:text-blue-400"})}),h?e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"p-4 rounded-lg bg-green-50 dark:bg-green-900/20 border border-green-200 dark:border-green-800 space-y-2",children:[e.jsx("div",{className:"text-sm font-medium text-green-800 dark:text-green-200",children:"✓ Profile Ready"}),e.jsx("div",{className:"text-sm text-green-600 dark:text-green-300",children:"Your fan account will be set up and you can start exploring amazing creators."})]}),e.jsx("div",{className:"py-3"})]}):e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"p-4 rounded-lg bg-muted/20 space-y-2",children:[e.jsx("div",{className:"text-sm font-medium",children:"Your Profile Summary:"}),e.jsxs("div",{className:"text-sm text-muted-foreground",children:[e.jsxs("div",{children:["Username: @",g]}),e.jsx("div",{children:"Role: Fan"}),e.jsxs("div",{children:["Email: ",j]})]})]}),e.jsx("p",{className:"text-xs text-muted-foreground",children:'Click "Complete Registration" below to finish creating your account.'})]})]})]}):e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"text-center space-y-2",children:[e.jsx("h3",{className:"text-xl font-semibold",children:"Choose Your Content Categories"}),e.jsxs("p",{className:"text-sm text-muted-foreground",children:["Select up to ",m," categories that best describe your content. Your first selection becomes your primary category."]}),o.length>0&&e.jsxs("div",{className:"text-xs text-muted-foreground",children:[o.length," of ",m," selected",o.length<m&&` • ${m-o.length} more available`]})]}),K?e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4",children:[...Array(6)].map((s,t)=>e.jsx("div",{className:"h-24 bg-muted/50 rounded-lg animate-pulse"},t))}):e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4","data-testid":"category-selection",children:[v.map(s=>{const t=O[s.icon]||w,r=o.includes(s.id),i=x===s.id,N=r&&!i,U=o.length>=m&&!r;return e.jsxs("button",{type:"button",onClick:()=>te(s.id),"data-testid":`category-${s.slug}`,disabled:U,className:`
                    relative p-4 rounded-lg border-2 transition-all duration-200 text-left hover:border-primary/50
                    ${r?i?"border-primary bg-primary/10 shadow-md":"border-blue-500 bg-blue-50 dark:bg-blue-900/20 shadow-md":U?"border-border bg-muted/30 opacity-50 cursor-not-allowed":"border-border hover:border-border/80 hover:bg-muted/50"}
                  `,children:[e.jsxs("div",{className:"flex items-start space-x-3",children:[e.jsx("div",{className:"p-2 rounded-lg bg-white/10",children:e.jsx(t,{className:"w-5 h-5",style:{color:s.color}})}),e.jsxs("div",{className:"flex-1",children:[e.jsx("div",{className:"font-medium text-sm mb-1",children:s.name}),e.jsx("div",{className:"text-xs text-muted-foreground leading-relaxed whitespace-normal break-words",children:s.description||`Create and share ${s.name.toLowerCase()} content`})]})]}),i&&e.jsx(I,{variant:"secondary",className:"absolute -top-2 -right-2 text-xs px-2 py-1 bg-primary text-primary-foreground","data-testid":`primary-badge-${s.slug}`,children:"Primary"}),N&&e.jsx(I,{variant:"outline",className:"absolute -top-2 -right-2 text-xs px-2 py-1 bg-blue-100 dark:bg-blue-900 text-blue-700 dark:text-blue-300 border-blue-300 dark:border-blue-700","data-testid":`secondary-badge-${s.slug}`,children:"Secondary"})]},s.id)}),e.jsx("div",{className:`
              relative p-4 rounded-lg border-2 transition-all duration-200 text-left
              ${c.trim()?"border-primary bg-primary/10":"border-dashed border-border hover:border-border/80 hover:bg-muted/50"}
            `,children:e.jsxs("div",{className:"flex items-start space-x-3",children:[e.jsx("div",{className:"p-2 rounded-lg bg-white/10",children:e.jsx(Pe,{className:"w-5 h-5 text-muted-foreground"})}),e.jsxs("div",{className:"flex-1 space-y-3",children:[e.jsxs("div",{children:[e.jsx(u,{htmlFor:"customCategory",className:"text-sm font-medium",children:"Other Category"}),e.jsx(y,{id:"customCategory",placeholder:"Enter custom category name",value:c,onChange:s=>L(s.target.value),className:"mt-1"})]}),c.trim()&&e.jsxs("div",{children:[e.jsx(u,{htmlFor:"customCategoryDescription",className:"text-sm",children:"Description (optional)"}),e.jsx(Ce,{id:"customCategoryDescription",placeholder:"Describe your content category...",value:A,onChange:s=>$(s.target.value),rows:2,className:"mt-1"})]})]})]})})]}),o.length>1&&e.jsxs("div",{className:"space-y-3",children:[e.jsxs("div",{className:"text-center",children:[e.jsx(u,{className:"text-sm font-medium",children:"Select Your Primary Category"}),e.jsx("p",{className:"text-xs text-muted-foreground mt-1",children:"This will be displayed prominently on your profile"})]}),e.jsx("div",{className:"grid grid-cols-2 gap-3",children:v.filter(s=>o.includes(s.id)).map(s=>{const t=O[s.icon]||w,r=x===s.id;return e.jsx("button",{type:"button",onClick:()=>b(s.id),"data-testid":`primary-category-${s.slug}`,className:`
                        p-3 rounded-lg border transition-all duration-200 text-left
                        ${r?"border-primary bg-primary/20 shadow-sm":"border-border hover:border-border/80 hover:bg-muted/50"}
                      `,children:e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(t,{className:"w-4 h-4",style:{color:s.color}}),e.jsx("span",{className:"text-sm font-medium",children:s.name})]})},s.id)})})]})]}),ce=()=>{var s;return e.jsxs("div",{className:"space-y-6",children:[e.jsx("div",{className:"text-center space-y-2",children:h?e.jsx(e.Fragment,{children:e.jsx("h3",{className:"text-xl font-semibold",children:"Almost done!"})}):e.jsxs(e.Fragment,{children:[e.jsx("h3",{className:"text-xl font-semibold",children:"Ready to Create!"}),e.jsx("p",{className:"text-sm text-muted-foreground",children:"Review your profile details below and complete your registration when ready."})]})}),e.jsxs("div",{className:"text-center space-y-4",children:[e.jsx("div",{className:"w-12 h-12 bg-yellow-100 dark:bg-yellow-900/30 rounded-full flex items-center justify-center mx-auto",children:e.jsx(q,{className:"w-6 h-6 text-yellow-600 dark:text-yellow-400"})}),h?e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"p-4 rounded-lg bg-green-50 dark:bg-green-900/20 border border-green-200 dark:border-green-800 space-y-2",children:[e.jsx("div",{className:"text-sm font-medium text-green-800 dark:text-green-200",children:"✓ Profile Ready"}),e.jsx("div",{className:"text-sm text-green-600 dark:text-green-300",children:"Your creator account will be set up with all the details you've provided."})]}),e.jsx("div",{className:"py-3"})]}):e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"p-4 rounded-lg bg-muted/20 space-y-2",children:[e.jsx("div",{className:"text-sm font-medium",children:"Your Profile Summary:"}),e.jsxs("div",{className:"text-sm text-muted-foreground",children:[e.jsxs("div",{children:["Username: @",g]}),e.jsx("div",{children:"Role: Creator"}),e.jsxs("div",{children:["Primary Category: ",c.trim()?c:(s=v.find(t=>t.id===x))==null?void 0:s.name]}),o.length>1&&e.jsxs("div",{children:["Secondary Categories (",o.length-1,"): ",o.filter(t=>t!==x).map(t=>{var r;return(r=v.find(i=>i.id===t))==null?void 0:r.name}).filter(Boolean).join(", ")]})]})]}),e.jsx("p",{className:"text-xs text-muted-foreground",children:'Click "Complete Registration" below to finish creating your account.'})]})]})]})},de=n==="creator"&&l===2;return e.jsx("div",{className:"min-h-screen bg-background flex items-center justify-center p-4",children:e.jsxs("div",{className:`w-full ${de?"max-w-5xl":"max-w-md"} space-y-6`,children:[oe(),e.jsxs(ge,{className:"bg-gradient-card border-border/50",children:[e.jsx(pe,{className:"text-center",children:e.jsxs(fe,{children:[l===2&&n==="fan"&&"Almost done!",l===3&&"Complete your creator profile"]})}),e.jsxs(ye,{className:"space-y-6",children:[e.jsxs("form",{onSubmit:ie,className:"space-y-4",children:[l===1&&le(),l===2&&ne(),l===3&&ce(),e.jsxs("div",{className:"flex justify-between",children:[l>1&&e.jsxs(f,{type:"button",variant:"outline",onClick:ae,children:[e.jsx(Se,{className:"w-4 h-4 mr-2"}),"Back"]}),e.jsx("div",{className:"ml-auto",children:l<E?e.jsxs(f,{type:"button",onClick:re,children:["Next",e.jsx(Me,{className:"w-4 h-4 ml-2"})]}):e.jsx(f,{type:"submit",disabled:M,children:M?"Creating account...":h?"Create My Account":"Complete Registration"})})]})]}),e.jsx("div",{className:"text-center",children:e.jsxs("p",{className:"text-sm text-muted-foreground",children:["Already have an account?"," ",e.jsx(Y,{to:"/login",className:"text-blue-500 hover:underline font-medium",children:"Sign in"})]})})]})]})]})})};export{Ve as Signup};
