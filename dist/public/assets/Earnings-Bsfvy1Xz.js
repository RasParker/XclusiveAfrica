import{u as X,r as n,a as Z,j as e,C as i,g as l,o as E,d as h,e as u,f as D,z as H,l as m,B as G,L as _}from"./index-DnjzDop3.js";import{C as B,a as L,b as O}from"./collapsible-B5WvucI8.js";import{D as j}from"./dollar-sign-CzBPYBMC.js";import{T as ee}from"./trending-up-BqdnV6XC.js";import{C as I}from"./chevron-up-CD9nw7va.js";import{P as se}from"./plus-9blh9VHl.js";import{C as te}from"./calendar-We5RV4OF.js";const ae=({tier:a})=>e.jsx(i,{className:"bg-gradient-card border-border/50",children:e.jsx(l,{className:"p-4",children:e.jsxs("div",{className:"space-y-3",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("h4",{className:"font-medium text-foreground text-sm",children:a.name}),e.jsxs(m,{variant:"secondary",className:"text-xs",children:[a.percentage.toFixed(1),"%"]})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-4 text-sm",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-muted-foreground",children:"Price"}),e.jsxs("p",{className:"font-medium",children:["GHS ",a.price.toFixed(2)]})]}),e.jsxs("div",{children:[e.jsx("p",{className:"text-muted-foreground",children:"Subscribers"}),e.jsx("div",{className:"flex items-center gap-2",children:e.jsx(m,{variant:"outline",className:"rounded-full w-6 h-6 p-0 flex items-center justify-center text-xs",children:a.subscribers})})]})]}),e.jsxs("div",{className:"pt-2 border-t border-border/20",children:[e.jsx("p",{className:"text-muted-foreground text-sm",children:"Monthly Revenue"}),e.jsxs("p",{className:"font-semibold text-foreground",children:["GHS ",a.monthlyRevenue.toFixed(2)]})]})]})})}),xe=()=>{var g,y,v,w,S,k;const{user:a}=X();n.useState("all-time");const[p,Y]=n.useState(!1),[f,$]=n.useState(!1),[b,M]=n.useState([]),[t,W]=n.useState(null),[re,z]=n.useState([]),[c,A]=n.useState([]),[U,q]=n.useState({subscribers:0,monthlyEarnings:0}),[J,N]=n.useState(!0),{toast:K}=Z();n.useEffect(()=>{a!=null&&a.id&&Q()},[a]);const Q=async()=>{try{N(!0);const s=await fetch(`/api/payouts/creator/${a.id}/current-earnings`);if(s.ok){const o=await s.json();W(o.data)}const r=await fetch(`/api/payouts/creator/${a.id}/history?limit=10`);if(r.ok){const o=await r.json();M(o.data)}const C=await fetch(`/api/creator/${a.id}/analytics`);if(C.ok){const o=await C.json();q(o)}const P=await fetch(`/api/creators/${a.id}/tiers`);if(P.ok){const o=await P.json();z(o)}const F=await fetch(`/api/creator/${a.id}/tier-performance`);if(F.ok){const R=(await F.json()).map(d=>{const x=d.revenue||0;return{name:d.name,price:parseFloat(d.price),subscribers:d.subscribers||0,monthlyRevenue:x,percentage:0}}),T=R.reduce((d,x)=>d+x.monthlyRevenue,0),V=R.map(d=>({...d,percentage:T>0?d.monthlyRevenue/T*100:0}));A(V)}}catch(s){console.error("Error fetching payout data:",s),K({title:"Error",description:"Failed to load earnings data",variant:"destructive"})}finally{N(!1)}};return e.jsx("div",{className:"min-h-screen bg-background",children:e.jsxs("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-4 sm:py-8",children:[e.jsxs("div",{className:"mb-8",children:[e.jsx("h1",{className:"text-2xl sm:text-3xl font-bold text-foreground mb-2",children:"Earnings Overview"}),e.jsx("p",{className:"text-sm sm:text-base text-muted-foreground",children:"Track your revenue and financial performance"})]}),e.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 gap-4 sm:gap-6 mb-6 sm:mb-8",children:[e.jsx(i,{className:"bg-gradient-to-br from-green-500 to-green-600 text-white border-0",children:e.jsx(l,{className:"p-4 sm:p-6",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-green-100 text-xs sm:text-sm mb-1",children:"Total Monthly Revenue"}),e.jsxs("p",{className:"text-2xl sm:text-3xl font-bold",children:["GHS ",((g=t==null?void 0:t.gross_revenue)==null?void 0:g.toFixed(2))||"0.00"]})]}),e.jsx(j,{className:"w-6 h-6 sm:w-8 sm:h-8 text-white opacity-70",strokeWidth:1})]})})}),e.jsx(i,{className:"bg-gradient-to-br from-blue-500 to-blue-600 text-white border-0",children:e.jsx(l,{className:"p-4 sm:p-6",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-blue-100 text-xs sm:text-sm mb-1",children:"Total Active Subscribers"}),e.jsx("p",{className:"text-2xl sm:text-3xl font-bold",children:U.subscribers||0})]}),e.jsx(E,{className:"w-6 h-6 sm:w-8 sm:h-8 text-white opacity-70",strokeWidth:1})]})})}),e.jsx(i,{className:"bg-gradient-to-br from-cyan-400 to-cyan-500 text-white border-0 sm:col-span-2 lg:col-span-1",children:e.jsx(l,{className:"p-4 sm:p-6",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-cyan-100 text-xs sm:text-sm mb-1",children:"Est. Net Revenue*"}),e.jsxs("p",{className:"text-2xl sm:text-3xl font-bold",children:["GHS ",((y=t==null?void 0:t.net_payout)==null?void 0:y.toFixed(2))||"0.00"]})]}),e.jsx(ee,{className:"w-6 h-6 sm:w-8 sm:h-8 text-cyan-200",strokeWidth:1})]})})})]}),e.jsx(B,{open:p,onOpenChange:Y,className:"mb-6 sm:mb-8",children:e.jsxs(i,{className:"bg-gradient-card border-border/50",children:[e.jsx(h,{children:e.jsx(L,{asChild:!0,children:e.jsxs("div",{className:"flex items-center justify-between cursor-pointer",children:[e.jsxs("div",{children:[e.jsx(u,{className:"text-base sm:text-lg",children:"Revenue Breakdown by Tier"}),e.jsx(D,{className:"text-sm",children:"Detailed breakdown of your subscription tiers"})]}),p?e.jsx(I,{className:"w-5 h-5 text-muted-foreground"}):e.jsx(H,{className:"w-5 h-5 text-muted-foreground"})]})})}),e.jsx(O,{children:e.jsxs(l,{children:[e.jsx("div",{className:"hidden sm:block overflow-x-auto",children:e.jsxs("table",{className:"w-full",children:[e.jsx("thead",{children:e.jsxs("tr",{className:"border-b border-border/50",children:[e.jsx("th",{className:"text-left py-3 px-4 font-medium text-muted-foreground text-sm",children:"Tier Name"}),e.jsx("th",{className:"text-left py-3 px-4 font-medium text-muted-foreground text-sm",children:"Price"}),e.jsx("th",{className:"text-left py-3 px-4 font-medium text-muted-foreground text-sm",children:"Subscribers"}),e.jsx("th",{className:"text-left py-3 px-4 font-medium text-muted-foreground text-sm",children:"Monthly Revenue"}),e.jsx("th",{className:"text-left py-3 px-4 font-medium text-muted-foreground text-sm",children:"Percentage"})]})}),e.jsx("tbody",{children:c.length>0?e.jsxs(e.Fragment,{children:[c.map((s,r)=>e.jsxs("tr",{className:"border-b border-border/20",children:[e.jsx("td",{className:"py-3 px-4 font-medium text-foreground text-sm",children:s.name}),e.jsxs("td",{className:"py-3 px-4 text-muted-foreground text-sm",children:["GHS ",s.price.toFixed(2)]}),e.jsx("td",{className:"py-3 px-4",children:e.jsx(m,{variant:"outline",className:"rounded-full w-6 h-6 p-0 flex items-center justify-center text-xs",children:s.subscribers})}),e.jsxs("td",{className:"py-3 px-4 font-medium text-foreground text-sm",children:["GHS ",s.monthlyRevenue.toFixed(2)]}),e.jsx("td",{className:"py-3 px-4",children:e.jsxs(m,{variant:"secondary",className:"text-xs",children:[s.percentage.toFixed(1),"%"]})})]},r)),e.jsxs("tr",{className:"bg-muted/20",children:[e.jsx("td",{className:"py-3 px-4 font-semibold text-foreground text-sm",children:"Total"}),e.jsx("td",{className:"py-3 px-4 text-sm",children:"-"}),e.jsx("td",{className:"py-3 px-4",children:e.jsx(m,{variant:"outline",className:"rounded-full w-6 h-6 p-0 flex items-center justify-center text-xs bg-green-100 text-green-700",children:c.reduce((s,r)=>s+r.subscribers,0)})}),e.jsxs("td",{className:"py-3 px-4 font-semibold text-foreground text-sm",children:["GHS ",c.reduce((s,r)=>s+r.monthlyRevenue,0).toFixed(2)]}),e.jsx("td",{className:"py-3 px-4 font-semibold text-foreground text-sm",children:"100%"})]})]}):e.jsx("tr",{children:e.jsx("td",{colSpan:5,className:"py-8 text-center text-muted-foreground",children:e.jsxs("div",{className:"flex flex-col items-center gap-2",children:[e.jsx(j,{className:"w-8 h-8"}),e.jsx("span",{children:"No subscription tiers created yet"}),e.jsx(G,{variant:"outline",size:"sm",asChild:!0,className:"mt-2",children:e.jsx(_,{to:"/creator/tiers",children:"Create Tiers"})})]})})})})]})}),e.jsx("div",{className:"sm:hidden space-y-4",children:c.length>0?e.jsxs(e.Fragment,{children:[c.map((s,r)=>e.jsx(ae,{tier:s},r)),e.jsx(i,{className:"bg-muted/20 border-border/50",children:e.jsx(l,{className:"p-4",children:e.jsxs("div",{className:"space-y-3",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("h4",{className:"font-semibold text-foreground",children:"Total Summary"}),e.jsx(m,{variant:"outline",className:"bg-green-100 text-green-700",children:"100%"})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-4 text-sm",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-muted-foreground",children:"Total Subscribers"}),e.jsx("p",{className:"font-semibold",children:c.reduce((s,r)=>s+r.subscribers,0)})]}),e.jsxs("div",{children:[e.jsx("p",{className:"text-muted-foreground",children:"Total Revenue"}),e.jsxs("p",{className:"font-semibold",children:["GHS ",c.reduce((s,r)=>s+r.monthlyRevenue,0).toFixed(2)]})]})]})]})})})]}):e.jsx(i,{className:"bg-gradient-card border-border/50",children:e.jsx(l,{className:"p-6",children:e.jsxs("div",{className:"text-center py-4",children:[e.jsx(j,{className:"w-12 h-12 text-muted-foreground mx-auto mb-4"}),e.jsx("h3",{className:"text-lg font-medium mb-2",children:"No subscription tiers"}),e.jsx("p",{className:"text-muted-foreground text-sm mb-4",children:"Create subscription tiers to start tracking revenue breakdown."}),e.jsx(G,{variant:"outline",size:"sm",asChild:!0,children:e.jsxs(_,{to:"/creator/tiers",children:[e.jsx(se,{className:"w-4 h-4 mr-2"}),"Create Tiers"]})})]})})})})]})})]})}),e.jsx(B,{open:f,onOpenChange:$,className:"mb-6 sm:mb-8",children:e.jsxs(i,{className:"bg-gradient-card border-border/50",children:[e.jsx(h,{children:e.jsx(L,{asChild:!0,children:e.jsxs("div",{className:"flex items-center justify-between cursor-pointer",children:[e.jsx(u,{className:"text-base sm:text-lg",children:"Payment Information"}),f?e.jsx(I,{className:"w-5 h-5 text-muted-foreground"}):e.jsx(H,{className:"w-5 h-5 text-muted-foreground"})]})})}),e.jsx(O,{children:e.jsxs(l,{children:[e.jsx("div",{className:"bg-blue-50 border-l-4 border-blue-400 p-4 mb-6 rounded-r",children:e.jsxs("div",{className:"flex",children:[e.jsx("div",{className:"flex-shrink-0",children:e.jsx("div",{className:"w-5 h-5 rounded-full bg-blue-400 flex items-center justify-center",children:e.jsx("span",{className:"text-white text-xs",children:"!"})})}),e.jsx("div",{className:"ml-3",children:e.jsxs("p",{className:"text-sm text-blue-800",children:[e.jsx("strong",{children:"Payment Processing:"})," Payments are processed monthly via Paystack. Your earnings will be transferred to your linked bank account after deducting Paystack's transaction fees."]})})]})}),e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6 sm:gap-8",children:[e.jsxs("div",{children:[e.jsx("h4",{className:"font-medium text-foreground mb-4 text-sm sm:text-base",children:"This Month's Projections:"}),e.jsxs("div",{className:"space-y-2 text-sm",children:[e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"text-muted-foreground",children:"Gross Revenue:"}),e.jsxs("span",{className:"font-medium",children:["GHS ",((v=t==null?void 0:t.gross_revenue)==null?void 0:v.toFixed(2))||"0.00"]})]}),e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"text-muted-foreground",children:"Platform Fee (5%):"}),e.jsxs("span",{className:"font-medium",children:["GHS ",((w=t==null?void 0:t.platform_fee)==null?void 0:w.toFixed(2))||"0.00"]})]}),e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"text-muted-foreground",children:"Paystack Fees (3.5%):"}),e.jsxs("span",{className:"font-medium",children:["GHS ",((S=t==null?void 0:t.paystack_fees)==null?void 0:S.toFixed(2))||"0.00"]})]}),e.jsx("div",{className:"border-t pt-2 mt-2",children:e.jsxs("div",{className:"flex justify-between font-semibold",children:[e.jsx("span",{children:"Net Revenue:"}),e.jsxs("span",{children:["GHS ",((k=t==null?void 0:t.net_payout)==null?void 0:k.toFixed(2))||"0.00"]})]})})]})]}),e.jsxs("div",{children:[e.jsx("h4",{className:"font-medium text-foreground mb-4 text-sm sm:text-base",children:"Payment Schedule:"}),e.jsx("p",{className:"text-sm text-muted-foreground",children:"Payments are processed automatically by Paystack on the subscriber's billing date. Your earnings are transferred to your bank account within 2-3 business days."})]})]})]})})]})}),e.jsxs(i,{className:"bg-gradient-card border-border/50",children:[e.jsxs(h,{children:[e.jsx(u,{className:"text-base sm:text-lg",children:"Payout History"}),e.jsx(D,{className:"text-sm",children:"Your processed payouts and pending transfers"})]}),e.jsx(l,{children:J?e.jsxs("div",{className:"text-center py-8",children:[e.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-accent mx-auto mb-4"}),e.jsx("p",{className:"text-muted-foreground",children:"Loading payout history..."})]}):b.length===0?e.jsxs("div",{className:"text-center py-8",children:[e.jsx(te,{className:"w-12 h-12 text-muted-foreground mx-auto mb-4"}),e.jsx("h3",{className:"font-medium text-foreground mb-2",children:"No Payouts Yet"}),e.jsx("p",{className:"text-sm text-muted-foreground",children:"Your first payout will appear here once you reach the minimum threshold of GHS 10.00"})]}):e.jsx("div",{className:"space-y-4",children:b.map(s=>e.jsxs("div",{className:"flex items-center justify-between p-4 rounded-lg border border-border/50",children:[e.jsx("div",{className:"flex-1",children:e.jsx("div",{className:"flex items-center gap-3",children:e.jsxs("div",{children:[e.jsxs("h4",{className:"font-medium text-foreground",children:[new Date(s.period_start).toLocaleDateString()," - ",new Date(s.period_end).toLocaleDateString()]}),e.jsxs("div",{className:"flex items-center gap-2 mt-1",children:[e.jsx(m,{variant:s.status==="completed"?"default":s.status==="pending"?"secondary":"destructive",className:"text-xs",children:s.status}),e.jsx(m,{variant:"outline",className:"text-xs",children:s.payout_method})]})]})})}),e.jsxs("div",{className:"text-right",children:[e.jsxs("div",{className:"text-lg font-semibold text-foreground",children:["GHS ",parseFloat(s.amount).toFixed(2)]}),e.jsx("p",{className:"text-xs text-muted-foreground",children:s.processed_at?new Date(s.processed_at).toLocaleDateString():"Pending"})]})]},s.id))})})]})]})})};export{xe as Earnings};
