import{i as M,j as e,A as _,m as $,n as z,k as J,S as O,l as S,B as L,a as W,r as i,aw as C,ab as q,C as w,g as U,I as H,d as G,e as K,f as Q}from"./index-DnjzDop3.js";import{S as T,a as F,b as A,c as k,d}from"./select-BgAE-lOE.js";import{C as X}from"./circle-check-big-CTWGQ5qD.js";import{E as Y}from"./EdgeToEdgeContainer-kS07pzFb.js";import{L as Z}from"./LoadingSpinner-D0nQGNMo.js";import{T as ee,a as se,b as p,c as j}from"./tabs-Tn3DyEKi.js";import{S as ae}from"./search-tyvWbnyU.js";import"./chevron-up-CD9nw7va.js";/**
 * @license lucide-react v0.453.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const te=M("Ban",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"m4.9 4.9 14.2 14.2",key:"1m5liu"}]]),f=({user:a,onSuspendUser:n})=>e.jsxs("div",{className:"flex flex-col sm:flex-row sm:items-center sm:justify-between p-4 rounded-lg border border-border/50 gap-4",children:[e.jsxs("div",{className:"flex items-center gap-3 sm:gap-4 min-w-0 flex-1",children:[e.jsxs(_,{className:"w-10 h-10 sm:w-12 sm:h-12 flex-shrink-0",children:[e.jsx($,{src:a.avatar?a.avatar.startsWith("/uploads/")?a.avatar:`/uploads/${a.avatar}`:void 0}),e.jsx(z,{children:a.username.charAt(0).toUpperCase()})]}),e.jsxs("div",{className:"min-w-0 flex-1",children:[e.jsxs("div",{className:"flex items-center gap-2 mb-1",children:[e.jsx("p",{className:"font-medium text-foreground truncate text-sm sm:text-base",children:a.username}),a.role==="creator"&&e.jsx(J,{className:"w-4 h-4 text-accent flex-shrink-0"}),a.role==="admin"&&e.jsx(O,{className:"w-4 h-4 text-primary flex-shrink-0"})]}),e.jsx("p",{className:"text-sm text-muted-foreground truncate",children:a.email}),e.jsxs("div",{className:"flex flex-wrap items-center gap-2 mt-2",children:[e.jsx(S,{variant:"outline",className:"text-xs capitalize",children:a.role}),e.jsx(S,{variant:a.status==="active"?"success":"destructive",className:"text-xs",children:a.status})]})]})]}),e.jsxs("div",{className:"flex flex-col sm:flex-row sm:items-center gap-3 sm:gap-4",children:[e.jsxs("div",{className:"text-left sm:text-right",children:[e.jsxs("p",{className:"text-sm font-medium",children:["Joined: ",new Date(a.joined).toLocaleDateString()]}),a.role==="creator"&&e.jsxs("div",{className:"text-xs text-muted-foreground",children:[a.subscribers," subscribers â€¢ $",a.revenue," revenue"]})]}),e.jsx(L,{variant:"outline",size:"sm",onClick:()=>n(a.id),className:"w-full sm:w-auto",children:a.status==="suspended"?e.jsxs(e.Fragment,{children:[e.jsx(X,{className:"w-4 h-4 mr-1"}),"Activate"]}):e.jsxs(e.Fragment,{children:[e.jsx(te,{className:"w-4 h-4 mr-1"}),"Suspend"]})})]})]}),xe=()=>{const{toast:a}=W(),[n,b]=i.useState([]),[B,y]=i.useState(!0),[g,E]=i.useState(""),[v,o]=i.useState("all"),[N,m]=i.useState("all"),[h,P]=i.useState("all");i.useEffect(()=>{R()},[]);const R=async()=>{try{y(!0);const l=(await C("/api/admin/users")).map(t=>({id:t.id.toString(),username:t.username,email:t.email,role:t.role,status:t.status||"active",joined:new Date(t.created_at).toISOString().split("T")[0],subscribers:t.total_subscribers||0,revenue:parseFloat(t.total_earnings||"0"),avatar:t.avatar}));b(l)}catch(s){console.error("Failed to fetch users:",s),a({title:"Error",description:"Failed to load users. Please try again.",variant:"destructive"})}finally{y(!1)}},r=n.filter(s=>{const l=s.username.toLowerCase().includes(g.toLowerCase())||s.email.toLowerCase().includes(g.toLowerCase()),t=v==="all"||s.role===v,x=N==="all"||s.status===N;let c=!0;return h==="creators"?c=s.role==="creator":h==="fans"?c=s.role==="fan":h==="banned"&&(c=s.status==="suspended"),l&&t&&x&&c}),u=async s=>{try{const l=n.find(x=>x.id===s),t=(l==null?void 0:l.status)==="suspended"?"active":"suspended";await C(`/api/admin/users/${s}/status`,{method:"PUT",body:JSON.stringify({status:t})}),b(x=>x.map(c=>c.id===s?{...c,status:t}:c))}catch(l){console.error("Failed to suspend/activate user:",l)}},V=()=>n.filter(s=>s.role==="creator"),D=()=>n.filter(s=>s.role==="fan"),I=()=>n.filter(s=>s.status==="suspended");return e.jsx(q,{children:e.jsx("div",{className:"flex-1 flex flex-col min-h-0",children:e.jsxs(Y,{maxWidth:"7xl",enablePadding:!0,enableTopPadding:!0,children:[e.jsxs("div",{className:"mb-6 sm:mb-8 text-center sm:text-left",children:[e.jsx("h1",{className:"text-2xl sm:text-3xl font-bold text-foreground mb-2 flex items-center gap-2 justify-center sm:justify-start",children:"Manage Users"}),e.jsx("p",{className:"text-sm sm:text-base text-muted-foreground",children:"View and manage platform users"})]}),e.jsx(w,{className:"bg-gradient-card border-border/50 mb-4 sm:mb-6",children:e.jsx(U,{className:"p-4 sm:p-6",children:e.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-4 gap-3 sm:gap-4",children:[e.jsxs("div",{className:"relative",children:[e.jsx(ae,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 text-muted-foreground w-4 h-4"}),e.jsx(H,{placeholder:"Search users...",value:g,onChange:s=>E(s.target.value),className:"pl-10"})]}),e.jsxs(T,{value:v,onValueChange:o,children:[e.jsx(F,{children:e.jsx(A,{placeholder:"Filter by role"})}),e.jsxs(k,{children:[e.jsx(d,{value:"all",children:"All Roles"}),e.jsx(d,{value:"creator",children:"Creators"}),e.jsx(d,{value:"fan",children:"Fans"}),e.jsx(d,{value:"admin",children:"Admins"})]})]}),e.jsxs(T,{value:N,onValueChange:m,children:[e.jsx(F,{children:e.jsx(A,{placeholder:"Filter by status"})}),e.jsxs(k,{children:[e.jsx(d,{value:"all",children:"All Status"}),e.jsx(d,{value:"active",children:"Active"}),e.jsx(d,{value:"suspended",children:"Suspended"})]})]}),e.jsx(L,{variant:"outline",className:"w-full sm:w-auto",children:"Export Users"})]})})}),e.jsxs(w,{className:"bg-gradient-card border-border/50",children:[e.jsxs(G,{className:"text-center sm:text-left",children:[e.jsxs(K,{className:"text-base sm:text-xl",children:["Platform Users (",r.length,")"]}),e.jsx(Q,{className:"text-sm",children:"Manage user accounts and permissions"})]}),e.jsx(U,{children:e.jsxs(ee,{value:h,onValueChange:P,className:"space-y-6",children:[e.jsxs(se,{className:"mb-6 mx-auto sm:mx-0",children:[e.jsxs(p,{value:"all",onClick:()=>{o("all"),m("all")},children:["All Users",e.jsx("span",{className:"ml-2 text-xs opacity-70",children:n.length})]}),e.jsxs(p,{value:"creators",onClick:()=>{o("creator"),m("all")},children:["Creators",e.jsx("span",{className:"ml-2 text-xs opacity-70",children:V().length})]}),e.jsxs(p,{value:"fans",onClick:()=>{o("fan"),m("all")},children:["Fans",e.jsx("span",{className:"ml-2 text-xs opacity-70",children:D().length})]}),e.jsxs(p,{value:"banned",onClick:()=>{o("all"),m("suspended")},children:["Banned",e.jsx("span",{className:"ml-2 text-xs opacity-70",children:I().length})]})]}),B?e.jsx("div",{className:"flex justify-center py-8",children:e.jsx(Z,{})}):e.jsxs(e.Fragment,{children:[e.jsx(j,{value:"all",className:"space-y-4",children:r.length>0?r.map(s=>e.jsx(f,{user:s,onSuspendUser:u},s.id)):e.jsx("p",{className:"text-center text-muted-foreground py-8",children:"No users found matching your criteria."})}),e.jsx(j,{value:"creators",className:"space-y-4",children:r.length>0?r.map(s=>e.jsx(f,{user:s,onSuspendUser:u},s.id)):e.jsx("p",{className:"text-center text-muted-foreground py-8",children:"No creators found matching your criteria."})}),e.jsx(j,{value:"fans",className:"space-y-4",children:r.length>0?r.map(s=>e.jsx(f,{user:s,onSuspendUser:u},s.id)):e.jsx("p",{className:"text-center text-muted-foreground py-8",children:"No fans found matching your criteria."})}),e.jsx(j,{value:"banned",className:"space-y-4",children:r.length>0?r.map(s=>e.jsx(f,{user:s,onSuspendUser:u},s.id)):e.jsx("p",{className:"text-center text-muted-foreground py-8",children:"No suspended users found."})})]})]})})]})]})})})};export{xe as ManageUsers};
