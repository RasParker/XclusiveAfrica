import{u as A,r as n,j as e,C as c,g as i,o as _,d as N,e as y,f as v}from"./index-DnjzDop3.js";import{P as F}from"./progress-CdD86Rs-.js";import{T as P,a as G,b as x}from"./tabs-Tn3DyEKi.js";import{H}from"./heart-BIzJO6uv.js";import{F as L}from"./file-text-CmNfjj7m.js";import{D as W}from"./dollar-sign-CzBPYBMC.js";const q=()=>{const{user:o}=A(),[r,w]=n.useState({subscribers:0,monthlyEarnings:0,totalEarnings:0,growthRate:0,engagementRate:0,postsThisMonth:0}),[M,k]=n.useState([]),[j,D]=n.useState([]),[T,g]=n.useState(!0);n.useState("overview"),n.useEffect(()=>{(async()=>{if(o)try{g(!0);const t=await fetch(`/api/creator/${o.id}/analytics`);if(t.ok){const a=await t.json();w(a)}const l=await fetch(`/api/creator/${o.id}/content`);if(l.ok){const a=await l.json();k(a)}const m=await fetch(`/api/creators/${o.id}/subscribers`);if(m.ok){const a=await m.json(),d=new Date,S=["January","February","March","April","May","June","July","August","September","October","November","December"],p=[];for(let u=2;u>=0;u--){const b=new Date(d.getFullYear(),d.getMonth()-u,1),R=S[b.getMonth()],C=a.filter(E=>{const f=new Date(E.created_at);return f.getMonth()===b.getMonth()&&f.getFullYear()===b.getFullYear()}).length;p.push({month:R,subscribers:C})}D(p)}}catch(t){console.error("Error fetching analytics data:",t)}finally{g(!1)}})()},[o]);const h=M.filter(s=>s.status==="published").sort((s,t)=>t.likes_count+t.comments_count-(s.likes_count+s.comments_count)).slice(0,3);return T?e.jsx("div",{className:"min-h-screen bg-background flex items-center justify-center",children:e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-primary mx-auto mb-4"}),e.jsx("p",{className:"text-muted-foreground",children:"Loading analytics..."})]})}):e.jsx("div",{className:"min-h-screen bg-background",children:e.jsxs("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-8",children:[e.jsxs("div",{className:"mb-8",children:[e.jsx("h1",{className:"text-2xl sm:text-3xl font-bold text-foreground mb-2",children:"Analytics Dashboard"}),e.jsx("p",{className:"text-sm sm:text-base text-muted-foreground",children:"Track your performance and growth"})]}),e.jsxs(P,{defaultValue:"overview",className:"space-y-6",children:[e.jsxs(G,{className:"mb-6",children:[e.jsx(x,{value:"overview",children:"Overview"}),e.jsx(x,{value:"content",children:"Content"}),e.jsx(x,{value:"audience",children:"Audience"}),e.jsx(x,{value:"revenue",children:"Revenue"})]}),e.jsxs("div",{className:"grid md:grid-cols-2 lg:grid-cols-4 gap-6 mb-8",children:[e.jsx(c,{className:"bg-gradient-card border-border/50",children:e.jsx(i,{className:"p-6",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-sm font-medium text-muted-foreground",children:"Total Subscribers"}),e.jsx("p",{className:"text-2xl font-bold text-foreground",children:r.subscribers.toLocaleString()}),e.jsxs("p",{className:"text-xs text-success",children:["+",r.growthRate,"% this month"]})]}),e.jsx(_,{className:"h-8 w-8 text-white opacity-70",strokeWidth:1})]})})}),e.jsx(c,{className:"bg-gradient-card border-border/50",children:e.jsx(i,{className:"p-6",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-sm font-medium text-muted-foreground",children:"Engagement Rate"}),e.jsxs("p",{className:"text-2xl font-bold text-foreground",children:[r.engagementRate,"%"]}),e.jsx("p",{className:"text-xs text-success",children:"+5.2% this month"})]}),e.jsx(H,{className:"h-8 w-8 text-white opacity-70",strokeWidth:1})]})})}),e.jsx(c,{className:"bg-gradient-card border-border/50",children:e.jsx(i,{className:"p-6",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-sm font-medium text-muted-foreground",children:"Posts This Month"}),e.jsx("p",{className:"text-2xl font-bold text-foreground",children:r.postsThisMonth}),e.jsxs("p",{className:"text-xs text-success",children:["+",Math.round(r.postsThisMonth/Math.max(r.postsThisMonth-2,1)*100-100),"% vs last month"]})]}),e.jsx(L,{className:"h-8 w-8 text-white opacity-70",strokeWidth:1})]})})}),e.jsx(c,{className:"bg-gradient-card border-border/50",children:e.jsx(i,{className:"p-6",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-sm font-medium text-muted-foreground",children:"Monthly Earnings"}),e.jsxs("p",{className:"text-2xl font-bold text-foreground",children:["GHS ",parseFloat(r.monthlyEarnings||0).toFixed(2)]}),e.jsxs("p",{className:"text-xs text-success",children:["+",r.growthRate,"% vs last month"]})]}),e.jsx(W,{className:"h-8 w-8 text-white opacity-70",strokeWidth:1})]})})})]}),e.jsxs("div",{className:"grid lg:grid-cols-2 gap-6",children:[e.jsxs(c,{className:"bg-gradient-card border-border/50",children:[e.jsxs(N,{children:[e.jsx(y,{children:"Content Performance"}),e.jsx(v,{children:"Your top performing posts this month"})]}),e.jsx(i,{className:"space-y-4",children:h.length>0?h.map((s,t)=>{const l=s.likes_count+s.comments_count,m=Math.max(...h.map(d=>d.likes_count+d.comments_count),1),a=Math.round(l/m*100);return e.jsxs("div",{className:"space-y-2",children:[e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsx("span",{className:"text-sm font-medium truncate max-w-[200px]",children:s.title}),e.jsxs("span",{className:"text-sm text-muted-foreground",children:[l," interactions"]})]}),e.jsx(F,{value:a,className:"h-2"})]},s.id)}):e.jsxs("div",{className:"text-center text-muted-foreground py-4",children:[e.jsx("p",{children:"No published posts yet"}),e.jsx("p",{className:"text-xs",children:"Create some content to see performance data"})]})})]}),e.jsxs(c,{className:"bg-gradient-card border-border/50",children:[e.jsxs(N,{children:[e.jsx(y,{children:"Subscriber Growth"}),e.jsx(v,{children:"Monthly subscriber trends"})]}),e.jsx(i,{children:e.jsx("div",{className:"space-y-4",children:j.length>0?j.map((s,t)=>e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsx("span",{className:"text-sm",children:s.month}),e.jsxs("span",{className:"text-sm font-medium",children:["+",s.subscribers," subscribers"]})]},t)):e.jsxs("div",{className:"text-center text-muted-foreground py-4",children:[e.jsx("p",{children:"No subscriber data available"}),e.jsx("p",{className:"text-xs",children:"Growth trends will appear as you gain subscribers"})]})})})]})]})]})]})})};export{q as Analytics};
